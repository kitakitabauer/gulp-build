var http=require("http"),fs=require("fs"),socketio=require("socket.io"),setting=require("./999_param.js"),server=http.createServer(),io=socketio.listen(server),MEMBER={},setMember=function(e,t){MEMBER[e]=t},deleteMember=function(e){delete MEMBER[e]},modifyMember=function(e,t){void 0!==MEMBER[e]&&(MEMBER[e]=t)},getMember=function(){var e="";for(var t in MEMBER)e+=MEMBER[t]+", ";return console.log("result : "+e),e};server.on("request",function(e,t){fs.readFile("./044_client.html",function(e,r){e&&(console.log(e),t.writeHead(500),t.end("Server error : "+e)),t.writeHead(200,{"Content-Type":"text/html; charset=UTF-8"}),t.end(r)})}),server.listen(setting.PORT,setting.IP,setting.startServer),io.sockets.on("connection",function(e){setMember(e.id,"名無し"),io.sockets.emit("rewriteMember",getMember()),e.on("addMenber",function(t){console.log("name : "+t),console.log(e.id),setMember(e.id,t),io.sockets.emit("rewriteMember",getMember())}),e.on("modifyName",function(t){console.log("modify name : "+t),console.log(e.id),modifyMember(e.id,t),io.sockets.emit("rewriteMember",getMember())}),e.on("disconnect",function(){deleteMember(e.id),io.sockets.emit("rewriteMember",getMember())})});